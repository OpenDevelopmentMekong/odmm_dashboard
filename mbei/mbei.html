<html>
  <head>
    <link rel="stylesheet" href="styles.css">
    <script src="https://d3js.org/d3.v3.js"></script>

    <script src="https://d3js.org/d3-axis.v1.min.js"></script>
    <script src="https://d3js.org/d3-selection.v1.min.js"></script>
    <script src="https://d3js.org/d3-scale.v3.min.js"></script>
    <!--<script src="https://d3js.org/d3-transition.v1.min.js"></script>-->
    <script src="https://d3js.org/d3-timer.v1.min.js"></script>
    <script src="https://d3js.org/d3-path.v1.min.js"></script>
    <script src="https://d3js.org/d3-shape.v1.min.js"></script>

    <script class="internal" src="variables.js"></script>
    <script class="internal" src="geoVariables.js"></script>
    <script class="internal" src="radarChart.js"></script>
    <script class="internal" src="barChart.js"></script>
    <script class="internal" src="unit1.js"></script>
    <script class="internal" src="unit2.js"></script>
    <script class="internal" src="unit3.js"></script>
    <script class="internal" src="unit4.js"></script>
  </head>
  <body>
    <!-- <a class="wpckan_dataset_resource_url button download"
      href="https://data.opendevelopmentmekong.net/dataset/217c73e8-f456-4392-a43e-1ba2a0694a92/resource/9d40f3cb-e45a-43d3-b771-93aa6ba5a540/download/mmrairport2015.zip"
      data-ga-event="Dataset|resource_download|217c73e8-f456-4392-a43e-1ba2a0694a92/9d40f3cb-e45a-43d3-b771-93aa6ba5a540">
      <i class="fa fa-download"></i>Download
    </a> -->
    <div class="unit intro">
      <span class="subunit mainImage"></span>
      <span class="subunit about">
        <table>
          <tr>
            <td>
              and there and here and there and here and there and here and there and
              there and here and there and here
              there and here and there and here
              there and here and there and here
              here and there and here and go to this link if you want to
              <a id="aboutLink" href="https://www.opendevelopmentmyanmar.net/ycdc2019">
              read more</a>
            </td>
          </tr>
        </table>
      </span>
    </div>

    <div class="unit donors">
      <img width="160px" height="160px" src="donorLogos/ukaid.png"/></span>
      <img width="240px" height="160px" src="donorLogos/dana.png"/>
      <img width="240px" height="160px" src="donorLogos/taf.png"/>
    </div>

    <div class="unit unit1">
    <!--  <button type="button" onclick="drawNationChart(false, 'unit1RadarChart');">States/Regions</button> |
      <button type="button" onclick="drawNationChart(true, 'unit1RadarChart');">Townships</button>
    -->
    <div class="subunit unit1RadarChart">
      <h3>Median National Subindex Scores</h3>
    </div>
    <div class="subunit unit1BarChart">
      <h3>National MBEI Rankings</h3>
    </div>

    </div>

    <hr/>

    <div class="unit unit2">
      <h3>Explore subindex scores for states and regions or townships</h3>
      <select id="subnationalDropdown" onchange="drawSubNationChart(areaNameFromDropdown('#subnationalDropdown'), unit2Township, '.unit2RadarChart');"></select>
      <button type="button" onclick="unit2Township = false; populateSubnationalDropdown(unit2Township, '#subnationalDropdown'); drawSubNationChart(areaNameFromDropdown('#subnationalDropdown'), unit2Township, '.unit2RadarChart'); drawSubnationBar(areaNameFromDropdown('#subnationalDropdown'), unit2Township, '.unit2BarChart');">States/Regions</button> |
      <button type="button" onclick="unit2Township = true; populateSubnationalDropdown(unit2Township, '#subnationalDropdown'); drawSubNationChart(areaNameFromDropdown('#subnationalDropdown'), unit2Township, '.unit2RadarChart'); drawSubnationBar(areaNameFromDropdown('#subnationalDropdown'), unit2Township, '.unit2BarChart');">Townships</button>
      <div class="subunit charts">
        <div class="subunit mapSelector"></div>
        <div class="subunit unit2RadarChart"></div>
        <div class="subunit unit2BarChart"></div>
      </div>
    </div>

    <hr/>

    <div class="unit unit3">
      <h3>Compare subindex scores between two areas</h3>
      <div id="areaSelector">
        <div id="select1Color"></div><select id="select1" onchange="changeRadar('#select1', '#select2', unit3Township)"></select>
        <div id="select2Color"></div><select id="select2" onchange="changeRadar('#select2', '#select1', unit3Township)"></select>
      </div>
      <div id="areaLevelSelector">
        <button type="button" onclick="unit3Township = false; setAreaLevel(srData, '.unit3', false); changeRadar('#select1','#select2', false);">States/Regions</button> |
        <button type="button" onclick="unit3Township = true; setAreaLevel(tspData, '.unit3', true); changeRadar('#select1','#select2', true);">Townships</button>
      </div>
      <div class="radarChart" align="center"></div>
    </div>

    <hr/>

    <div class="unit unit4">
      <h3>Performance rankings for each subindicator</h3>
      <div class="subunit unit4Switch">
        <button type="button" onclick="unit4Township = false; drawSubindexBar('.unit4BarChart', buildBarData(unit4Township, 'sub1')); changeSubindexTitle('sub1');">States/Regions</button> |
        <button type="button" onclick="unit4Township = true; drawSubindexBar('.unit4BarChart', buildBarData(unit4Township, 'sub1')); changeSubindexTitle('sub1');">Townships</button>
      </div>
      <div class="subunit unit4Buttons">
      </div>
      <div class="subunit unit4BarChart">
        <h4><a class="subindexName"></a></h4>
      </div>
    </div>
    <script>

    /* @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ */
    /* @@@@           Initializing         @@@@ */
    /* @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ */
    var srData = d3.csv.parse(mbei_stateregion);
    var tspData = d3.csv.parse(mbei_township);
    var subDataSpliceIndex = 4;      // how many columns to skip to reach 'sub1'
    //Unit 1
    drawNationChart(false, '.unit1RadarChart');
    var unit1BarData = reshapeForUnit1BarChart(srData);
    barChart(unit1BarData, '.unit1BarChart', {tiers: true});
    //Unit 2
    drawMap();
    var unit2Township = false;
    populateSubnationalDropdown(unit2Township, '#subnationalDropdown');
    drawSubNationChart(areaNameFromDropdown('#subnationalDropdown'), unit2Township, '.unit2RadarChart');
    drawSubnationBar(areaNameFromDropdown('#subnationalDropdown'), unit2Township, '.unit2BarChart');
    // Unit 3
    var unit3Township = false;
    setAreaLevel(srData, '.unit3');
    changeRadar('#select1', '#select2', unit3Township);
    // Unit 4
    var currentSubindex = 'sub1';
    var unit4Township = false;
    generateSubindexButtons('.unit4Buttons');
    drawSubindexBar('.unit4BarChart', buildBarData(unit4Township, 'sub1'));
    changeSubindexTitle('sub1');

    /* @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ */
    /* @@@@ General purpose functions here @@@@ */
    /* @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ */

    // NOTE: Function will break if township or stateregion values are not unique
    function lookup(toFind, searchVar, returnVar, township) {
      var returnList = [];
      var data = {};
      if (township == true) {
        data = tspData;
      } else {
        data = srData;
      }
      for (var i in toFind) { returnList.push(0); }
      // Loop through the data table
      for (i in data) {
        var item = data[i][searchVar];
        // See if each line contains the items we want to find
        for (var j in toFind) {
          if (item == toFind[j]) {
           // When found, return a list of translated items
           returnList[j] = data[i][returnVar];
          }
        }
      }
      return returnList;
    }
  </script>
  </body>
</html>
